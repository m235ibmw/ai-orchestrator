# Google Apps Script - 世界史概論 第2回 確認テスト自動生成

このスクリプトは、Googleスプレッドシートから自動的にGoogle Formを生成します。

## セットアップ手順

### 1. 新しいGoogleスプレッドシートを作成

1. [Google Sheets](https://sheets.google.com) にアクセス
2. 新しいスプレッドシートを作成
3. タイトルを「世界史概論 第2回 確認テスト」に変更

### 2. Apps Script エディタを開く

1. メニューから「拡張機能」→「Apps Script」を選択
2. Apps Script エディタが新しいタブで開きます

### 3. スクリプトをコピー&ペースト

1. `createForm.js` の内容を全てコピー
2. Apps Script エディタのデフォルトコード（`function myFunction() {}`）を削除
3. コピーした内容を貼り付け
4. 「保存」ボタンをクリック（Ctrl+S / Cmd+S）
5. プロジェクト名を「フォーム自動生成」に変更

### 4. スプレッドシートに戻って実行

1. スプレッドシートのタブに戻る
2. ページをリロード（F5 / Cmd+R）
3. 数秒後、メニューバーに「フォーム自動生成」が表示される

### 5. サンプルデータを作成

1. メニューから「フォーム自動生成」→「1. サンプルデータ作成」を選択
2. 初回実行時、権限の承認が求められます：
   - 「権限を確認」をクリック
   - Googleアカウントを選択
   - 「詳細」→「○○（安全ではないページ）に移動」をクリック
   - 「許可」をクリック
3. サンプルデータが「設問データ」シートに作成されます

### 6. Google Formを生成

1. メニューから「フォーム自動生成」→「2. フォーム生成」を実行
2. ダイアログに以下の情報が表示されます：
   - **フォームURL**: 学生が回答するURL
   - **編集URL**: フォームを編集するURL
3. これらのURLは「フォーム情報」シートにも記録されます

## 生成される設問内容

以下の5問が自動生成されます：

1. **問1**: 古代ギリシャで発展した政治制度は？
   - 選択肢: 民主制 / 君主制 / 貴族制 / 共和制
   - 正解: 民主制

2. **問2**: ローマ共和制の最高執政官の名称は？
   - 選択肢: 執政官（コンスル）/ 独裁官 / 護民官 / 元老院議員
   - 正解: 執政官（コンスル）

3. **問3**: パックス・ロマーナとは何を意味するか？
   - 選択肢: ローマによる平和 / ローマの戦争 / ローマの法律 / ローマの建築
   - 正解: ローマによる平和

4. **問4**: ローマ帝国が東西に分割されたのは西暦何年か？
   - 選択肢: 395年 / 476年 / 27年 / 509年
   - 正解: 395年

5. **問5**: 古代ローマを代表する建築物は？
   - 選択肢: コロッセオ / パルテノン神殿 / ピラミッド / 万里の長城
   - 正解: コロッセオ

## 生成後の作業

### フォームURLをclassroom-siteに組み込む

1. 「フォーム情報」シートから**フォームURL**をコピー
2. `classroom-site/data/courses.json` を編集
3. 世界史概論の第2回レッスンに `formUrl` フィールドを追加

例:
```json
{
  "id": 2,
  "title": "第2回: ギリシャ・ローマ時代",
  "description": "古代ギリシャとローマの歴史、文化、政治制度について学びます。",
  "pdfUrl": "/pdfs/world-history-2.pdf",
  "formUrl": "https://docs.google.com/forms/d/e/YOUR_FORM_ID/viewform"
}
```

## トラブルシューティング

### 「フォーム自動生成」メニューが表示されない
- ページをリロード（F5）してください
- Apps Scriptの保存後、数秒待ってからリロードしてください

### 権限エラーが出る
- 「詳細」→「安全でないページに移動」をクリックして承認してください
- これは自作スクリプトのため、Googleの認証を受けていないためです

### フォームが作成されない
- 「設問データ」シートが存在するか確認してください
- ヘッダー行（問題番号、設問、選択肢1-4、正解）が正しいか確認してください

## 注意事項

- このスクリプトはデモ用途のため、回答制限を設定していません（`setLimitOneResponsePerUser(false)`）
- 本番環境では `true` に変更して1人1回のみ回答可能にすることを推奨します
- 正解の設定は現在未実装です（Google Formの採点機能は手動設定が必要）
